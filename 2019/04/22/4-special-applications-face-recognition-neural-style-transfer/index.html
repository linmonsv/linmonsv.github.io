<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="What is face recognition?Liveness detection Face Verification  Input image, name&#x2F;ID Output whether the input image is that of the claimed person  Face Recognition  Has a database of K persons Get">
<meta property="og:type" content="article">
<meta property="og:title" content="4 Special applications : Face recognition &amp; Neural style transfer">
<meta property="og:url" content="http://example.com/2019/04/22/4-special-applications-face-recognition-neural-style-transfer/index.html">
<meta property="og:site_name" content="Water&#39;s Home">
<meta property="og:description" content="What is face recognition?Liveness detection Face Verification  Input image, name&#x2F;ID Output whether the input image is that of the claimed person  Face Recognition  Has a database of K persons Get">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/Siamese_network_Goal_of_learning.png">
<meta property="og:image" content="http://example.com/img/Visualizing_deep_layers_Layer_5.png">
<meta property="article:published_time" content="2019-04-22T06:25:53.000Z">
<meta property="article:modified_time" content="2022-07-05T01:29:39.532Z">
<meta property="article:author" content="Water">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/Siamese_network_Goal_of_learning.png">

<link rel="canonical" href="http://example.com/2019/04/22/4-special-applications-face-recognition-neural-style-transfer/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>4 Special applications : Face recognition & Neural style transfer | Water's Home</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Water's Home</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Just another Life Style</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/22/4-special-applications-face-recognition-neural-style-transfer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Water">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Water's Home">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          4 Special applications : Face recognition & Neural style transfer
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-22 14:25:53" itemprop="dateCreated datePublished" datetime="2019-04-22T14:25:53+08:00">2019-04-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-05 09:29:39" itemprop="dateModified" datetime="2022-07-05T09:29:39+08:00">2022-07-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/machine-learning/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep Learning</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deep-learning/" itemprop="url" rel="index"><span itemprop="name">deep-learning</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deep-learning/Deep-Learning-Specialization-Offered-By-deeplearning-ai/" itemprop="url" rel="index"><span itemprop="name">Deep Learning Specialization Offered By deeplearning.ai</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="What-is-face-recognition"><a href="#What-is-face-recognition" class="headerlink" title="What is face recognition?"></a>What is face recognition?</h2><p><strong>Liveness detection</strong> <strong>Face Verification</strong></p>
<ul>
<li>Input image, name&#x2F;ID</li>
<li>Output whether the input image is that of the claimed person</li>
</ul>
<p><strong>Face Recognition</strong></p>
<ul>
<li>Has a database of K persons</li>
<li>Get an input image</li>
<li>Output ID if the image is any of the K persons (or “not recognized”)</li>
</ul>
<p><strong>In fact we have a database of a hundred persons you probably need this to be even quite a bit higher than 99% for that to work well.</strong></p>
<h2 id="One-shot-learning"><a href="#One-shot-learning" class="headerlink" title="One-shot learning"></a>One-shot learning</h2><p>One of the challenges of face recognition is that you need to solve the one-shot learning problem. What that means is that, for most face recognition applications, you need to recognize a person given just one single image, or given just one example of that person’s face.  And historically, deep learning algorithms don’t work well if you have only one training example. So the carry-outs face recognition to carry out one-shot learning. So instead, to make this work, what you’re going to do instead is learning similarity function. [latex]d(img1, img2) &#x3D; degree\ of\ difference\ between\ images.[&#x2F;latex]   [latex]\left.\begin{matrix} If \ \ d(img1, img2) \leq \tau &amp; , same\\ \ \ \ \ \ \ \ \ \ \ \ &gt; \tau &amp; , different \end{matrix}\right\}[&#x2F;latex]  </p>
<h2 id="Siamese-network"><a href="#Siamese-network" class="headerlink" title="Siamese network"></a>Siamese network</h2><p><img src="/img/Siamese_network_Goal_of_learning.png"></p>
<h2 id="Triplet-loss"><a href="#Triplet-loss" class="headerlink" title="Triplet loss"></a>Triplet loss</h2><p>One way to learn the parameters of the neural network so that it gives you a good encoding for your pictures of faces is to define and apply gradient descent on the <strong>triplet loss function</strong>. In the terminology of the triplet loss what you’re going to do is always look at one anchor image and then you want the distance between the anchor and a positive image really a positive example meaning is the same person to be similar. Whereas you want the anchor when pairs are compared to the negative example for their distances to be much further apart. So this is what gives rise to the term triplet loss which is that you always be <strong>looking at three images at a time</strong>, you’ll be looking at an <strong>anchor</strong> image a <strong>positive</strong> image as well as a <strong>negative</strong> image. [latex]\left \ f(A) - f(P) \right \ ^2 - \left \ f(A) - f(N) \right \ ^2 + a \leq 0[&#x2F;latex] [latex]L(A,P,N) &#x3D; max (\left \ f(A) - f(P) \right \ ^2 - \left \ f(A) - f(N) \right \ ^2 + a, 0)[&#x2F;latex] For your face recognition system maybe you have only a single picture of someone you might be trying to recognize but for your training set you do need to make sure you have multiple images of the same person at least for some people in your training set so that you can have pairs of anchor and positive images. <strong>Choosing the triplets A,P,N :</strong> </p>
<p>During training, if A,P,N are chosen randomly, [latex]d(A,P) + a \leq d(A,N)[&#x2F;latex] is easily satisfied.</p>
<p>So to construct a training set what you want to do is to <strong>choose triplets A P and N that are hard to train</strong> on this is one domain where because of the sheer data volume sizes this is one domain where often it might be useful for you to download someone else’s pretrained model rather than do everything from scratch yourself.</p>
<h2 id="Face-verification-and-binary-classification"><a href="#Face-verification-and-binary-classification" class="headerlink" title="Face verification and binary classification"></a>Face verification and binary classification</h2><p>Take this pair of neural networks to take this siamese network and have them both compute these embeddings, maybe 128 dimensional embeddings, maybe even higher dimensional, and then have these be input to a logistic regression unit to then just make a prediction, where the target output will be 1 if both of these are the same persons, and 0 if both of these are of different persons. So this is a way to treat face recognition just as a binary classification problem. [latex]\hat y &#x3D; \sigma (\sum _{k&#x3D;1}^{128} w_i f(x^{(i)})_k - f(x^{(i)})_k + b)[&#x2F;latex]   <strong>Help your deployment significantly :</strong> </p>
<p>what you can do is actually pre compute that, so when the new employee walks in, what you can do is use this upper ConvNet to to compute that encoding and use it to then compare it  to your pre computed encoding, and then use that to make a prediction y hat.</p>
<h2 id="What-is-neural-style-transfer"><a href="#What-is-neural-style-transfer" class="headerlink" title="What is neural style transfer?"></a>What is neural style transfer?</h2><p>In order to implement neural style transfer, you need to look at the features extracted by ConvNets, at various layers, the shallow and the deeper layers of a ConvNets.</p>
<h2 id="What-are-deep-ConvNets-learning"><a href="#What-are-deep-ConvNets-learning" class="headerlink" title="What are deep ConvNets learning?"></a>What are deep ConvNets learning?</h2><p><img src="/img/Visualizing_deep_layers_Layer_5.png"></p>
<h2 id="Cost-function"><a href="#Cost-function" class="headerlink" title="Cost function"></a>Cost function</h2><p><strong>Given a content image C and the style image S, then the goal is to generate a new image G.</strong></p>
<p>[latex]J(G) &#x3D; \alpha J_{content}(C,G) + \beta J_{style}(S,G)[&#x2F;latex]</p>
<p><strong>Find the generated image G :</strong> </p>
<ol>
<li>Initiate G randomly (G : 100 * 100 * 3)</li>
<li>Use gradient descent to minimiza J(G)</li>
</ol>
<h2 id="Content-cost-function"><a href="#Content-cost-function" class="headerlink" title="Content cost function"></a>Content cost function</h2><ul>
<li>Say you use hidden layer l to compute content cost.</li>
<li>Use pre-trained ConvNet. (E.g., VGG network)</li>
</ul>
<p>[latex]J_{content}(C,G) &#x3D; \frac {1}{2} \left \ a^{[l](C)} - a^{[l](G)} \right \ ^ 2[&#x2F;latex]</p>
<ul>
<li>Let [latex]a^{[l](C)}[&#x2F;latex] and [latex]a^{[l](G)}[&#x2F;latex] be the activation of layer l on the images</li>
<li>If [latex]a^{[l](C)}[&#x2F;latex] and [latex]a^{[l](G)}[&#x2F;latex] are similar, both images have similar content</li>
</ul>
<h2 id="Style-cost-function"><a href="#Style-cost-function" class="headerlink" title="Style cost function"></a>Style cost function</h2><p>**Style matrix : ** Let [latex]a_{i,j,k}^{[l]}[&#x2F;latex] &#x3D; activation at [latex](i,j,k)[&#x2F;latex]. [latex]G^{[l](s)}[&#x2F;latex] is [latex]n_{c}^{[l]} \times n_{c}^{[l]}[&#x2F;latex] And it’s the degree of correlation that gives you one way of measuring how often these different high level features, such as vertical texture or this orange tint or other things as well. How often they occur and how often they occur together, and don’t occur together in different parts of an image. Define this style image. [latex]G_{kk’}^{[l](G)} &#x3D; \sum _{i&#x3D;1}^{n_H^{[l]}} \sum _{j&#x3D;1}^{n_W^{[l]}} a_{i,j,k}^{[l](G)} a_{i,j,k’}^{[l](G)} [&#x2F;latex] So G, defined using layer l and on the style image, is going to be a matrix, where the height and width of this matrix is the number of channels by number of channels. So in this matrix, the k, k prime element is going to measure how correlated our channels k and k prime. Style cost function : [latex]J_{style}^{[l]}(S,G) &#x3D; \frac{1}{(2n_H^{[l]}n_W^{[l]}n_C^{[l]})^2} \sum _{k} \sum _{k’} (G_{kk’}^{[l](S)} - G_{kk’}^{[l](G)})[&#x2F;latex]  </p>
<h2 id="1D-and-3D-generalizations-of-models"><a href="#1D-and-3D-generalizations-of-models" class="headerlink" title="1D and 3D generalizations of models"></a>1D and 3D generalizations of models</h2><p>For a long of 1d data applications you actually use a recurrent neural network. Three-dimensional. And one way to think of this data is if your data now has some height, some width and then also some depth.</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/04/19/3-object-detection/" rel="prev" title="3 Object detection">
      <i class="fa fa-chevron-left"></i> 3 Object detection
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/04/22/1-recurrent-neural-networks/" rel="next" title="1 Recurrent Neural Networks">
      1 Recurrent Neural Networks <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#What-is-face-recognition"><span class="nav-number">1.</span> <span class="nav-text">What is face recognition?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#One-shot-learning"><span class="nav-number">2.</span> <span class="nav-text">One-shot learning</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Siamese-network"><span class="nav-number">3.</span> <span class="nav-text">Siamese network</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Triplet-loss"><span class="nav-number">4.</span> <span class="nav-text">Triplet loss</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Face-verification-and-binary-classification"><span class="nav-number">5.</span> <span class="nav-text">Face verification and binary classification</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#What-is-neural-style-transfer"><span class="nav-number">6.</span> <span class="nav-text">What is neural style transfer?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#What-are-deep-ConvNets-learning"><span class="nav-number">7.</span> <span class="nav-text">What are deep ConvNets learning?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cost-function"><span class="nav-number">8.</span> <span class="nav-text">Cost function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Content-cost-function"><span class="nav-number">9.</span> <span class="nav-text">Content cost function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Style-cost-function"><span class="nav-number">10.</span> <span class="nav-text">Style cost function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1D-and-3D-generalizations-of-models"><span class="nav-number">11.</span> <span class="nav-text">1D and 3D generalizations of models</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Water"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Water</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">216</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">64</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/linmonsv" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;linmonsv" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:qin2@qq.com" title="E-Mail → mailto:qin2@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Water</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
